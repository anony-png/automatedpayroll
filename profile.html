<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>MotorPH â€” Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
<style>
  :root{--red:#c62828;--muted:#777;font-family:Inter,system-ui}
  body{margin:0;background:#f5f5f6;display:flex;align-items:center;justify-content:center;height:100vh}
  .phone{width:380px;max-width:96vw;border-radius:28px;background:white;box-shadow:0 18px 40px rgba(0,0,0,.08);overflow:hidden}
  header{background:linear-gradient(90deg,var(--red),#a21818);color:white;padding:14px}
  .content{padding:14px}
  input{width:100%;padding:10px;border-radius:8px;border:1px solid #eee;margin-bottom:8px}
  button{width:100%;padding:12px;border-radius:10px;border:0;background:var(--red);color:white}
  .muted{color:var(--muted);font-size:13px}
</style>
</head>
<body>
  <div class="phone">
    <header><div style="font-weight:700">Profile</div></header>
    <div class="content">
      <div class="muted">Update your personal details. Salary is used for payroll computation.</div>
      <input id="eid" disabled placeholder="Employee ID" />
      <input id="name" placeholder="Full name" />
      <input id="email" placeholder="Email" />
      <input id="phone" placeholder="Phone" />
      <input id="salary" placeholder="Monthly Salary (PHP)" type="number" />
      <button id="save">Save</button>
      <div style="margin-top:10px"><a href="dashboard.html">Back to Dashboard</a></div>
    </div>
  </div>

<script>
function getSession(){ return JSON.parse(localStorage.getItem('mp_session')||'null'); }
function getUsers(){ return JSON.parse(localStorage.getItem('mp_users')||'[]'); }
function saveUsers(u){ localStorage.setItem('mp_users', JSON.stringify(u)); }

const session = getSession();
if(!session){ alert('Login required'); location.href='index.html'; }
if(session.role === 'admin'){ alert('Admins should use admin panel.'); location.href='admin.html'; }

const users = getUsers();
const me = users.find(x => x.employeeId === session.id);
if(!me){ alert('Profile not found'); location.href='index.html'; }

document.getElementById('eid').value = me.employeeId;
document.getElementById('name').value = me.name || '';
document.getElementById('email').value = me.email || '';
document.getElementById('phone').value = me.phone || '';
document.getElementById('salary').value = me.salary || '';

document.getElementById('save').addEventListener('click', () => {
  me.name = document.getElementById('name').value.trim();
  me.email = document.getElementById('email').value.trim();
  me.phone = document.getElementById('phone').value.trim();
  me.salary = Number(document.getElementById('salary').value) || 0;
  saveUsers(users);
  alert('Profile saved.');
});
</script>
</body>
</html>
